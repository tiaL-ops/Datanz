<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>District Official</title>
  <link rel="stylesheet" href="/styles/government.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="top-nav">
    <div class="logo"><a href="/" id="datanzLink">DATANZ</a></div>
    <ul class="nav-links">
      <div class="dropdown">
        <li class="dropbtn">Menu</button>
        <div class="dropdown-content">
          <a href="/government">Home</a>
          <a href="/government/worst">Find the Worst Facilities</a>
          <a href="/government/advanced-search">Advanced Search</a>
        </div>
      </div>
      <li><a href="/auth/logout">Sign Out</a></li>
    </ul>
  </header>
  <main>
    <section class = "page">

  <h1>Welcome <%= username %></h1>

  <div class="scroll-wrapper">
    <h2>Worst Facilities</h2>
    <!-- <button type="button" onclick="setLastMonth()">Last 30 Days</button> -->

    <button type="button" class="scroll-arrow left" onclick="lefti('worstScroll')">&#8249;</button>
    <div class="scroll-container" id="worstScroll">
      <% bottomTenWorst.forEach(facility => { %>
        <div class="card">
          <h3><%= facility.name %></h3>
          <button type="button" onclick='openFacilityPopup(<%= JSON.stringify(facility).replace(/</g, '\\u003c') %>)' class = "btn-app">
            View Details
          </button>
        </div>
      <% }) %>
    </div>

    <button type="button" class="scroll-arrow right" onclick="scrollRight('worstScroll') ">&#8250;</button>
  </div>
  <div class="scroll-wrapper">
    <h2>Best Facilities</h2>
    <button type="button" class="scroll-arrow left" onclick="lefti('bestScroll')">&#8249;</button>

    <div class="scroll-container" id="bestScroll">
      <% topThreeBest.forEach(facility => { %>
        <div class="card">
          <h3><%= facility.name %></h3>
          <button type="button" class = "btn-app" onclick='openFacilityPopup(<%= JSON.stringify(facility).replace(/</g, '\\u003c') %>)'>

            View Details
          </button>
        </div>
      <% }) %>
    </div>
    <button type="button" class="scroll-arrow right" onclick="scrollRight('bestScroll')">&#8250;</button>
  </div>

  </section>

  <br>
  <section class = "page">
    <h2>Facility Rating Trends Over Time</h2>
    <div class="filter-group">
      <label for="trendFacilitySelect" style = "text-align: center;">Select Facility:</label>
      <select id="trendFacilitySelect">
        <option value="all" selected>All Facilities (default)</option>
      
        <optgroup label="By Facility">
          <% results.forEach(facility => { %>
            <option value="facility-<%= facility.facility_id %>"><%= facility.name %></option>
          <% }); %>
        </optgroup>
      
        <optgroup label="By Region">
          <option value="region-Arusha">Arusha</option>
          <option value="region-Kilimanjaro">Kilimanjaro</option>
          <option value="region-Tanga">Tanga</option>
        </optgroup>
      </select>
    </div>
    <canvas id="timeTrendChart" style="width: 600px; height: 200px; margin: auto; display: block;"></canvas>
  </section>

  <section class = "page">
  <h1>Other actions</h2>
  <img src="/assets/cs204.png" alt="rating" class="rating">
  <p><a href = "/government/worst">View Worst Facilities by Criteria</a></p>
  <p><a href = "/government/advanced-search">Advanced Search</a></p>
  </section>

  <div id="facilityModal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close-button" onclick="closeFacilityPopup()">&times;</span>
      <h2 id="modalFacilityName"></h2>
      <table>
        <thead>
          <tr>
            <th>Name</th><th>Code</th><th>Location</th><th>Avg Wait</th>
            <th>Avg Sat</th><th>% No Privacy</th><th>% No Permission</th>
            <th>% Missed Tests</th><th>% Missed Meds</th><th>Top Payment</th>
            <th>Top Problems</th><th>Top Positives</th>
          </tr>
        </thead>
        <tbody id="modalFacilityDetails">
          <!-- Dynamic content -->
        </tbody>
      </table>
    </div>
  </div>
  </div>
</main>
<button id="backToTop" class="back-to-top" title="Go to top">â†‘</button>

</body>

<script src="/js/government.js"></script>
<script>
 

</script>




</html>